---
title: "Data Wrangling Project: U.S. Beef Industry"
author: "Erdal Erol"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: spacelab
    toc: true
    toc_float: true
    toc_depth: 4
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, error = TRUE, warning= FALSE, message = FALSE)
```

```{r klippy, echo=FALSE, include=TRUE}
#remotes::install_github("rlesur/klippy")
klippy::klippy(position = c('top', 'right'))
```

# Synopsis

# Packages Required

```{r packages}
#install.packages("...")

#data wrangling
library(tidyverse)
library(ggplot2)
library(nycflights13)
library(data.table)
library(tidyfast)
library(dtplyr)

#mapping
library(cartography) 
library(rgdal)
library(sp)
library("rnaturalearth")
library("rnaturalearthdata")
library(usmap)
```

# 1. Introduction

# 2. Data

production

* cattle
```{r}
cattleinv_data =  read_csv("data/cattle inventory.csv")
cattleinv_data= as.data.table(cattleinv_data)
cattleinv_data = cattleinv_data[, c("YEAR","REFERENCE PERIOD", "STATE ANSI"):= NULL]
setnames(cattleinv_data,  "LOCATION","state")
setnames(cattleinv_data,  "TOTAL, NOT SPECIFIED in HEAD", "number")

```

```{r}
beef_cattle = cattleinv_data[COMMODITY=="CATTLE, COWS, BEEF"]
beef_cattle = beef_cattle[, c("COMMODITY"):= NULL]
beef_cattle_states = beef_cattle[2:51]
total = beef_cattle[1]
total
```



```{r}
plot_usmap(data = beef_cattle_states, values = "number", labels = TRUE,  color = "black")  + 
  scale_fill_continuous(name = "Beef Cattle Inventory",  low = "lightblue", high = "blue", label = scales::comma) + 
  labs(title = "U.S. Beef Cattle Inventory, by State-January 1, 2021") +
  theme(legend.position = "right")

```

```{r}

```

* beef 
```{r}


```


```{r}


```
trade

```{r}
export_data <- read_excel("data/beef_trade.xlsx", sheet = "export")

export_data = melt(export_data, id.vars ="country",
variable.name = "year", value.name = "export")

export_data = as.data.table(export_data, key="country")
export_data
```
* m
```{r}
import_data <- read_excel("data/beef_trade.xlsx", sheet = "import")

import_data = melt(import_data, id.vars ="country",
variable.name = "year", value.name = "import")

import_data = as.data.table(import_data, key = "country")
import_data
```

```{r}
trade_data = merge( export_data,import_data, by = c("country", "year"), all=T)
trade_data = trade_data[, trade_balance:= export-import] 
trade_data = trade_data[, us_status:= ifelse(trade_balance<0, "net_importer", "net_exporter")] 

trade_data[country=="Japan" & year=="2021" ]

total_trade = trade_data[country=="total" ]
setorder(total_trade, cols = -"year") 
total_trade

```


market

* supply


* prices


* products

consumption

* per capita data

geo data

* location of farms
* others


## 2.1. Data Sources
## 2.2. Data Preparation

# 3. Explanatory Data Analysis
## 3.1. Federal Level

## 3.2. State Level

## 3.3. Kentucky


# Summary

# References


 *external server*
<a href="https://selectorgadget.com/" target="_blank">SelectorGadget</a>



